<!-- Bootstrap Modal -->
@if (show()) {
<div class="modal fade show d-block" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel" (click)="closeDialog()">
  <div class="modal-dialog modal-dialog-centered" role="document" (click)="$event.stopPropagation()">
    <div class="modal-content border-0 shadow-lg">
      <!-- Header -->
      <div class="modal-header border-bottom">
        <h5 class="modal-title fw-semibold" id="shareModalLabel">Share Search Results</h5>
        <button
          type="button"
          class="btn-close"
          (click)="closeDialog()"
          aria-label="Close"
        ></button>
      </div>

      <!-- Body -->
      <div class="modal-body">
        @if (isGeneratingLink()) {
        <!-- Loading State -->
        <div class="text-center py-4">
          <fa-icon [icon]="faSpinner" class="fa-spin text-primary fs-3 mb-3"></fa-icon>
          <p class="text-muted mb-0">Generating share link...</p>
        </div>
        } @else if (error()) {
        <!-- Error State -->
        <div class="alert alert-danger d-flex align-items-center" role="alert">
          <fa-icon [icon]="faExclamationTriangle" class="me-2"></fa-icon>
          <div class="flex-grow-1">{{ error() }}</div>
          <button
            type="button"
            class="btn btn-sm btn-outline-danger ms-2"
            (click)="retryGeneration()"
          >
            Retry
          </button>
        </div>
        } @else if (shareLink()) {
        <!-- Success State -->
        <p class="text-muted mb-3">
          Share this link to let others view your search results with the same filters:
        </p>
        
        <div class="input-group">
          <input
            type="text"
            class="form-control font-monospace bg-light"
            [value]="shareLink()"
            readonly
            #linkInput
          />
          <button
            type="button"
            class="btn btn-primary"
            [class.btn-success]="linkCopied()"
            (click)="copyShareLink()"
            title="Copy to clipboard"
          >
            <fa-icon [icon]="linkCopied() ? faCheck : faCopy"></fa-icon>
          </button>
        </div>

        @if (linkCopied()) {
        <div class="alert alert-success mt-3 mb-0 py-2" role="alert">
          <fa-icon [icon]="faCheck" class="me-1"></fa-icon>
          Link copied to clipboard!
        </div>
        }
        }
      </div>

      <!-- Footer -->
      <div class="modal-footer border-top">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="closeDialog()"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Modal backdrop -->
<div class="modal-backdrop fade show"></div>
}
